pkgname=postmarketos-mkinitfs
pkgver=0.6.3
pkgrel=0
pkgdesc="Tool to generate initramfs images for postmarketOS"
url="https://github.com/postmarketOS"
# multipath-tools: kpartx
depends="busybox-extras lddtree cryptsetup kmod multipath-tools postmarketos-splash
	device-mapper parted e2fsprogs e2fsprogs-extra osk-sdl charging-sdl triggerhappyi
	lvm2"
triggers="$pkgname.trigger=/etc/postmarketos-mkinitfs/hooks:/usr/share/kernel/*"
source="init.sh.in init_functions.sh mkinitfs.sh"
arch="noarch"
license="GPL2"
provides="mkinitfs=0.0.1"
options="!check"

package() {
	mkdir -p "$pkgdir/usr/share/postmarketos-mkinitfs/"
	for file in init.sh.in init_functions.sh; do
		install -Dm644 "$srcdir/$file" \
			"$pkgdir/usr/share/postmarketos-mkinitfs/$file"
	done
	install -Dm755 "$srcdir/mkinitfs.sh" \
		"$pkgdir/sbin/mkinitfs"
	mkdir -p "$pkgdir/etc/postmarketos-mkinitfs/hooks/"
}
sha512sums="db50d2e18e72d9d15c0838e4637e3442303d3f9b2405f795beb897bb9c7b06e02d64a5d690c4c588f71209251aab59dbcbddab73a75bae2ccdc026b4c1584e77  init.sh.in
4658b182d629a768ac4677c9dd5a3582287786c71a10f772f6ddf94688480520560fd03451fb433869289041293cedd22f5c148bdd6efb0ebd8f642ad80ed506  init_functions.sh
55e1c522ab5a17230c0d7132979b22a0daba6e8d6e291ce5e99281bf88b17a8b4ac7a68f144183990145d7b09a28f80f9b629b6296e71ea3bd20bf3ebe60a49d  mkinitfs.sh"
